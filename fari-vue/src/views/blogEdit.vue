<template>
  <div
    id="mdEditor"
    class="vditor vditor--fullscreen"
  />
</template>

<script>
import Vditor from 'vditor'
export default {
  name: 'FariEditor',
  data () {
    return {
      editor: '',
      welcome: '# ğŸ‰ Welcome to use FariBlog Markdown Editor (suported by Vditor)!'
    }
  },
  mounted () {
    this.editor = new Vditor('mdEditor', {
      // mode: 'sv', é»˜è®¤ä¸ºå³æ—¶æ¸²æŸ“æ¨¡å¼
      // cdn: '..',
      cache: {
        enable: false
      },
      placeholder: this.welcome,
      minHeight: 600,
      width: 'auto',
      outline: true, // å¤§çº²æ¨¡å¼
      counter: {
        enable: 102400 // è®¡æ•°ï¼Œæç¤ºè§’æ ‡é—®é¢˜
      },
      toolbarConfig: {
        pin: true
      },
      // å·¥å…·æ é…ç½®å…·ä½“çœ‹ vditor ä½¿ç”¨æŒ‡å—
      toolbar: [
        {
          name: 'open_save',
          tip: 'æ‰“å¼€/ä¿å­˜',
          icon: '',
          toolbar: [
            {
              name: 'open_md',
              icon: 'æ‰“å¼€MD',
              click () {
                // this.open_md()
              }
            },
            {
              name: 'export_md',
              icon: 'å¯¼å‡ºMD',
              click () {
                // return this.save_md()
              }
            }
          ]
        },
        '|',
        'emoji',
        'headings',
        'bold',
        'italic',
        'strike',
        'link',
        '|',
        'edit-mode',
        {
          name: 'more',
          toolbar: [
            {
              name: 'about',
              icon: 'å…³äº',
              click () {
                this.showAbout()
              }
            }
          ]
        }],
      preview: {
        delay: 200
      },
      after: () => {
        // this.vditor.setValue('# ğŸ‰ï¸ Welcome to use Tauri Vditor!')
      }
    })
  },
  methods: {
    showAbout () {
      this.$message({
        type: 'info',
        message: 'è¿™æ˜¯åŸºäºVditorå®ç°çš„Webç«¯MarkDownå·¥å…·<br/>ğŸŠæ¬¢è¿ä½¿ç”¨~<br/>'
      })
    }
    // async open_md () {
    //   const filePath = await dialog.open({
    //     filter: 'md'
    //   })
    //   // Notification.info(JSON.stringify(file_path))
    //   const result = await readTextFile(filePath)
    //   // Notification.info(JSON.stringify(result))
    //   this.vditor.setValue(result)
    // },
    // async save_md () {
    //   const filePath = await dialog.save({
    //     filter: 'md'
    //   })
    //   await writeFile({
    //     path: filePath,
    //     contents: this.vditor.getValue()
    //   })
    // },
  }
}
</script>
<style scoped>
@import "~vditor/dist/index.css";
</style>
